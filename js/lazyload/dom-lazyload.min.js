/*! Common-Mdule - v0.1.0 - 2015-06-02 13:53:06 */
function DomLazyload(a){var b=this;a=a||{},b.defaults={eles:".lazy_wrapper",loadingCls:"wrapper_loading",lazyNav:"#lazy_nav",fatchType:"GET",fatchDataType:"html",offset:100,isFatchUrls:!0,done:function(){}},b.defaults=$.extend(b.defaults,a),b.init(),b.isShow()}DomLazyload.prototype={init:function(){var a=this;$(a.defaults.eles).on("showview",function(){a.showview(this)}),$(window).on("scroll resize",function(){a.isShow()})},isShow:function(){var a,b,c=this,d=$(c.defaults.eles),e=d.length,f="undefined"!=typeof document.compatMode&&"BackCompat"!=document.compatMode?document.documentElement:document.body,g=~~(f.scrollTop?f.scrollTop:window.scrollY);for(a=0;e>a;a++)b=d.eq(a),!b.data("isshow")&&g>b.offset().top-c.defaults.offset-f.clientHeight&&(b.data("isshow",1),b.trigger("showview"))},showview:function(a){var b=this,c=$(a);b.defaults.isFatchUrls?b.fatchMore(c,b.getUrlArr(a)):b.fatch(b.getUrl(a),b.defaults.fatchType,b.defaults.fatchDataType).done(function(a){c.removeClass(b.defaults.loadingCls),c.append(a),b.publish(c)})},getUrlArr:function(a){var b,c=this;return b=$(c.defaults.lazyNav).find("a").eq($(a).index(c.defaults.eles)).attr("href"),b.split(",")},getUrl:function(a){var b=this;return $(b.defaults.lazyNav).find("a").eq($(a).index(b.defaults.eles)).attr("href")},asyncEvent:function(a){var b,c=this,d=a.length,e=d,f=new jQuery.Deferred,g=[];for(b=0;d>b;b++)!function(b){c.fatch(a[b],c.defaults.fatchType,c.defaults.fatchDataType).done(function(a){g[b]=a,--e||f.resolve(g.join(""))})}(b);return f.promise()},fatchMore:function(a,b){var c=this;$.when(c.asyncEvent(b)).done(function(b){a.removeClass(c.defaults.loadingCls),a.append(b),c.publish(a)})},fatch:function(a,b,c){return $.ajax({url:a,type:b,dataType:c})},publish:function(a){this.defaults.done(a)}};